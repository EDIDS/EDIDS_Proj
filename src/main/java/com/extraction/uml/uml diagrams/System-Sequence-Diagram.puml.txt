@startuml

title System Sequence Diagram

actor User
participant System

User -> System : startGame
loop finish = false
  User -> System : move(direction)
  alt legal direction
    System --> User : displayNewRoom
    opt item
      User -> System : get(item)
      alt item.getWeight() <= freeWeight
        return item
      else item.getWeight() > freeWeight
        System --> User : Error(bag full)
      end
    end
    opt enemy
      loop
        alt
          User -> System : attack()
        else
          User -> System : defend()
        else
          User -> System : cure()
          alt hasMedikit  
            System -> System : cure(medikit)
          else hasnotMedikit
            System --> User : Error(item not found)
          end
        else
          User -> System : escape()
        end
      end
      System --> User : result
      opt result = loss
        System -> User : you lose
        System -> System : finish = true
      end
    end 
  else illegal direction
    System --> User : Error(illegal move)
  else finish line
    System -> User : you win
    System -> System : finish = true
  end
end

@enduml